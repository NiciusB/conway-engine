!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t=t||self).ConwayJs=i()}(this,function(){"use strict";var a=function(t,i,o){this.x=t,this.y=i,this.alive=o,this.aliveLastTick=null};"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var t,l=(function(t,i){t.exports=function(){return o.importState=function(t){var i=new o;return i.importState(t),i},o;function o(){return function(t){var i=0,o=0,n=0,s=1;0==t.length&&(t=[+new Date]);var e,r,h=(e=4022871197,(r=function(t){t=t.toString();for(var i=0;i<t.length;i++){var o=.02519603282416938*(e+=t.charCodeAt(i));o-=e=o>>>0,e=(o*=e)>>>0,e+=4294967296*(o-=e)}return 2.3283064365386963e-10*(e>>>0)}).version="Mash 0.9",r);i=h(" "),o=h(" "),n=h(" ");for(var a=0;a<t.length;a++)(i-=h(t[a]))<0&&(i+=1),(o-=h(t[a]))<0&&(o+=1),(n-=h(t[a]))<0&&(n+=1);h=null;var l=function(){var t=2091639*i+2.3283064365386963e-10*s;return i=o,o=n,n=t-(s=0|t)};return l.uint32=function(){return 4294967296*l()},l.fract53=function(){return l()+11102230246251565e-32*(2097152*l()|0)},l.version="Alea 0.9",l.args=t,l.exportState=function(){return[i,o,n,s]},l.importState=function(t){i=+t[0]||0,o=+t[1]||0,n=+t[2]||0,s=+t[3]||0},l}(Array.prototype.slice.call(arguments))}}()}(t={exports:{}},t.exports),t.exports);return function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.options=t,void 0===this.options.width&&(this.options.width=100),void 0===this.options.height&&(this.options.height=100),void 0===this.options.seed&&(this.options.seed=Date.now()),void 0===this.options.initialWorld&&(this.options.initialWorld=!1),void 0===this.options.rulestring&&(this.options.rulestring="B3/S23"),void 0===this.options.enableLastTickInfo&&(this.options.enableLastTickInfo=!1),void 0===this.options.wrapOnEdges&&(this.options.wrapOnEdges=!1),this.__initializeWorld=function(t,i){this.lookupTable=function(t){for(var i=t.split("/")[0].slice(1,1/0).split("").map(function(t){return parseInt(t)}),o=t.split("/")[1].slice(1,1/0).split("").map(function(t){return parseInt(t)}),n=[],s=0;s<512;s++){var e=s.toString(2),r="1"===(e="0".repeat(9-e.length)+e)[4],h=e.split("1").length-1-(r?1:0),a=null;a=r?-1!==o.indexOf(h):-1!==i.indexOf(h),n.push(a)}return n}(this.options.rulestring);var o=null;this.options.initialWorld||(o=new l(this.options.seed)),this.world=[];for(var n=0;n<i;n++){this.world.push([]);for(var s=0;s<t;s++){var e=null;if(this.options.initialWorld)if("function"==typeof this.options.initialWorld)e=this.options.initialWorld(n,s);else{if(!Array.isArray(this.options.initialWorld[n])||"undefined"===this.options.initialWorld[n][s])throw new Error("[conway-engine] Invalid initialWorld option");e=this.options.initialWorld[n][s]}else e=o()<.2;this.world[n].push(new a(s,n,e))}}this.__oldState=[];for(var r=0;r<i+2;r++){this.__oldState.push([]);for(var h=0;h<t+2;h++)this.__oldState[r].push(!1)}},this.__set_oldState_withWrap=function(){for(var t=0;t<this.height+2;t++){var i=t-1;if(0===t?i=this.height-1:t===this.height+1&&(i=0),this.world[i])for(var o=0;o<this.width+2;o++){var n=o-1;0===o?n=this.width-1:o===this.width+1&&(n=0),this.world[i][n]&&(this.__oldState[t][o]=this.world[i][n].alive)}}},this.__set_oldState_noWrap=function(){for(var t=1;t<=this.height;t++)for(var i=1;i<=this.width;i++){var o=this.world[t-1][i-1];o&&(this.__oldState[t][i]=o.alive)}},this.tick=function(){if(this.options.wrapOnEdges?this.__set_oldState_withWrap():this.__set_oldState_noWrap(),this.options.enableLastTickInfo)for(var t=0;t<this.height;t++)for(var i=0;i<this.width;i++)this.world[t][i].aliveLastTick=this.world[t][i].alive;for(var o=1;o<=this.height;o++)for(var n=(this.__oldState[o-1][0]?32:0)+(this.__oldState[o-1][1]?4:0)+(this.__oldState[o][0]?16:0)+(this.__oldState[o][1]?2:0)+(this.__oldState[o+1][0]?8:0)+(this.__oldState[o+1][1]?1:0),s=1;s<=this.width;s++)n=n%64*8+(this.__oldState[o-1][s+1]?4:0)+(this.__oldState[o][s+1]?2:0)+(this.__oldState[o+1][s+1]?1:0),this.world[o-1][s-1].alive=this.lookupTable[n]},this.width=this.options.width,this.height=this.options.height,this.__initializeWorld(this.width,this.height)}});
